
k1 = pow(g,a1*(p-1),n)
k1=(g^a1)^(p-1)%n
k1=(g^a1)^(p-1)+kn
#两边同时模p
k1%p=(g^a1)^(p-1)%p
根据费马小定理
k1%p=1
k1-1=kp
求出p


c1 = (pow(k1,b1,n)*flag)%n

c1=k1^b1*flag+kn
#两边同时模p
c1%p=k1^b1*flag%p
#k1%p=1
c1%p=flag%p
#因为flag<p
c1%p=flag
