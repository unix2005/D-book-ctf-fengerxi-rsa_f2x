扩展欧几里得定理
a,b
ax+by=gcd(a,b)
gcd(a,b)=1
ax+by=1
ax%b=1  ax = 1 mod b
by%a=1  by = 1 mod a
#利用扩展欧几里得定理 求出逆元
p1 = gmpy2.invert(p, q) 正整数
q1 = gmpy2.invert(q, p) 正整数
p*p1+q*q2=1
p,q 都是正整数。
p1 或 q1 必然是一个负整数。
#虽然q2是负整数，但是他也是逆元。q2*q%p=1
(q2+p)*q%p=1  q2+p=q1
q2+p=q1
#q2是负数 p2=p1 q2+p=q1
p*p2+q*(q2+p)=1
p*p2+q*q2+pq=1
#p2是负数 q2=q2 p2+q=q1
p*(p2+q)+q*q2=1
p*p2+q*q2+pq=1
#使用方程
p*p1+q*q1-pq=1
(p-1)*(q-1)=phi