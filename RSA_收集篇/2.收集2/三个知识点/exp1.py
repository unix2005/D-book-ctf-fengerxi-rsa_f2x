

e=65537
c = 35494000960995376837920740056228077355317423032231011492220103074424137961540766590205188655476757791956438216465338440845729448524405342067817882751400571616140288920633986958191613205877788639754335126143897602728396019752045445980427702946853578585314170145248155405528371972911532609117726527818972942261803488709684217136602705472966809275639655808193975291003639080670103255739133278644109527281617933690834985654430459044404168834842345293017415625896304326966872277738442756439544913956050365162132343222763547140599801036769910417414600318841831722689186811137959670212645127461765753114897270004899965793042467641448481840410164154620104270910471599974823410885675620092383872895721863293512818026988210840418025970176309736811257132047574873413026397537481518
hint = 66165114212153833260201838406396792219818963486859177561844852534176362757957752691859859036572932158447463854306023237618235421472652709602625727344716799860492643679973951937627995344556021976897078163951129242479083414583351371191020123711741866008046506466527107983051193696944913602606278239890813306350676030483720182817179368981154193820638742934830473906618544547397984512675624529307665381833091839742965219524338764080671069841004881407638033105649719302828040280952683854704878273473111002528067335966034804442577150748023024055007308601742093386015069743637712544342790349933040276692760247136801305522303154722697084311878563258210494457518930587756156101571352277690307138287686125507120109191940073986435398480241600035955276597307946790607032905832359748
n = 68019877154159652153994665118935209689083031707002979473786443484105326430485264369556118178060191146821834173954692274285462386963029872804588841139049451057439818805200786155970251989187974089855956706382210669663872342528884833213191627109980821706742029904755750236307964844271905687391869213177311291892896657824082409436471314102196877888372344020002590703035498843760674205921459336970319139451131268413343185288912149724212270990540389369312004802562124711017117810206712234312276522461983800820652877889451068572214243344804682548698332189237987346041986822006402751896117655246245701151601826728834235081315788398592087653856265395408532204953831278271280912601806779638238187767986212536845003318183269224401364761225330242027930222271005578256016945964492841
import libnum
import  gmpy2

p2q=libnum.gcd(hint*e**e-1,n)
print(p2q)
pq=n//p2q
print(pq)
p=p2q//pq
print(p)
print(gmpy2.is_prime(p))
q=pq//p
print(gmpy2.is_prime(q))
phi=p**2*q*(p-1)*(q-1)
d=libnum.invmod(e,phi)
m=pow(c,d,n)
print(libnum.n2s(m))
#b'flag{Cr1p'

# d^e%n=h
# 两边同时乘e^e
# e^e*d^e%n=e^e*h%n
# (ed)^e%n=e^e*h%n
# (ed)^e%n-1=e^e*h%n-1
# (ed)^e%n-1%n=e^e*h%n-1
# ((ed)^e-1)%n=e^e*h%n-1
# ((k*phi+1)^e-1)%n=e^e*h%n-1
# ((k*phi+1-1)%n=e^e*h%n-1
# (k*p2*q*(p-1)*(q-1))%n=e^e*h%n-1
#
# k*p=e^e*h%n-1
# k*p2q
# n=p3*q2
# p*q=h1
# p2*q=h2
# p*(p*q)=h2