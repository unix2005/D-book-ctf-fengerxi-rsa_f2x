



n= 28576274811010794362153160897556935178530640825011441539841241257190782139295561904323347128956873569754645071205043238985141474388531008367238218822591
c= 49502875285578675438052554215266678403659290915102322948363030271494959804587081871467110614683972929037615883922743651431683465100061968204901334627149795829429950385848753728500177164800064208215503246868631076011505268371936586645321659884527055007299822625570713613996139223348709621258028349513737798120

import gmpy2
import libnum

p=libnum.generate_prime(512)
q=gmpy2.next_prime(p)
n=p*q
print(p)
print(q)
print("n=",n)
print('n=', n>>520)
print('n=', n>>520<<520)

n1=n>>520<<520
p1,s=gmpy2.iroot(n1,2)
p=gmpy2.next_prime(p1)
print(p)


n= 28576274811010794362153160897556935178530640825011441539841241257190782139295561904323347128956873569754645071205043238985141474388531008367238218822591
c= 49502875285578675438052554215266678403659290915102322948363030271494959804587081871467110614683972929037615883922743651431683465100061968204901334627149795829429950385848753728500177164800064208215503246868631076011505268371936586645321659884527055007299822625570713613996139223348709621258028349513737798120
n1=n<<520
p1,s=gmpy2.iroot(n1,2)
p=gmpy2.next_prime(p1)
phi=p-1
e = 0x10001
d=libnum.invmod(e,phi)
m=pow(c,d,p)
print(libnum.n2s(int(m)))
