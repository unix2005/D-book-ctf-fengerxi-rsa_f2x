
(p+a)^q%n=h
#两边同时p次方
(p+a)^q*p%n=h^p%n
(p+a)^n=h^p+kn
#两边模上p
(p+a)^n%p=h^p%p
#根据费马小定理
(p+a)^n%p=h%p
#展开
a^n%p=h%p
a^n-h=kp
#求公约数p
p=gcd(a^n-h,n)