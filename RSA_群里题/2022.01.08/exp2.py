import libnum
from z3 import *


p1 = 5196196050705723138112029354241213560365131687283777103991974590050330881852293037857030837243139843347360405640059895049182607258744842918637025468416691
q1 = 6348855136381531315498600386011500088965179774532589776023316381462419038863507425114122666114524009822536486875402878926042335189942205851772971588914811
c = 63282442425364769361603505235966142893985650589817177416369151290644447029685823704984026247101140306565860740775935570861775035489995667315276076320468661500183173682414994192590926535733644915085251753700560860514158340566848621012798175092005695320985308654278089690864203374564983250793044163777615225734
e = 65541
d = 122297620802567932272431752376550733645082884507915937283008510000806801850121325362670337310514202668900078075448905729834351066168587008003347874120754463264395652516225963591350427478627227639330490916641343050747799692445329361968557854727026637067072688408629764479524345994057879613552701364053945043441



solver=Solver()
p=Int("p")
q=Int("q")
for k in range(e,1,-1):
    if (e * d - 1) % k == 0:
        print(k)
        phi = (e * d - 1) // k
        print(phi)
        solver.add((p-1)*(q-1)==phi)
        solver.add((q1*q+p1*p-1==p*q))
        if solver.check()==sat:
            print(solver.model())
            break

p = 13037022248776485455765657990760031649738172382291971431270088348293679826726124550312158873896310916822494678913767968443939161716318872022577275748319923
q = 10128772559601471072353923779846641051004718955169494777946479385229803757744931078384914461587380307767146578124123558724977391368157332433788725638715891
n=p*q
m=pow(c,d,n)
print(libnum.n2s(m))
