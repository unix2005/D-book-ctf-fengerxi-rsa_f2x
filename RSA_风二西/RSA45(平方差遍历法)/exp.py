import libnum
import gmpy2

c= 7584304618592653304211680259013751106492419901801709721781902525030524148634288745113464887904445968142597688522558510585650133956730763070655649892501168921457727950299923987725974199790714292596085653399447583478423038886014696216589515071124176093354723253969951066446543761962980441620036238614997510454089318656956162835580014710722383052414347903494171808892402151405363555436965202252241275144387922551240368880042565591408831787475270893173737839220607205775205024242281762312634204385178023896276772435013559399366012268219732278298908455489139875986173199049004965984895638775978192132979042120605073302851
n= 10578149390217080971372888336395451205611930027503625079842755351646245185967756689732461691028174012096904776467405482428751885712143873031012566376917332106897535549653940260635381212778688299572988994605389499614207245093865120625896122361533018032778023429634003238022209346580999010369737459791376443534441262154760292361747451970646049459950548483605818838927164251971295817329735312099498578459377655129999993379912844974209079213556260188295097488008026721815663032419998693141469035484664512061424195910330865887161714348111712728341078739642096786659774047876405247002745747497911505255348958715383186752113

e = 0x10001
a=gmpy2.iroot(n,2)[0]
while 1:
    b2=pow(a,2)-n
    if gmpy2.is_square(b2):
        b=gmpy2.iroot(b2,2)[0]
        q=a-b
        p=a+b
        break
    a+=1
print(n==p*q)
phi=(p-1)*(q-1)
d=libnum.invmod(e,phi)
m=pow(c,d,n)
print(libnum.n2s(int(m)))
